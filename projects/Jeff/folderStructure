package sharepoint;

import java.io.BufferedInputStream;
import java.io.File;
import java.io.FileOutputStream;
import java.io.IOException;
import java.net.MalformedURLException;
import java.net.URL;

import org.apache.commons.io.FilenameUtils;

public class CreateFolderDownloadFiles {

	public static void main(String[] args) throws MalformedURLException, IOException {
		// base where home folder will be :    C:\Users\vkoloyu\GIT\ls-team\yuriy_kolodiy\automation_scripts\PearsonProjects

		 {
			 
			 
			 String fileIN = "http://teams.inside.pearson.com/sch2/sim/instructional/Consulting%20First/Consulting%20First!%209-08-09.doc";
			 
			 String getfolderStructure = FilenameUtils.getPath(fileIN).replaceAll("http://teams.inside.pearson.com/", "");
			 
			 String getFilename = FilenameUtils.getName(fileIN);
			
			 String fileOut = getfolderStructure+ getFilename;
			 
			 System.out.println(fileOut);
			 
			 
			 //creating a folder structure here
			  try{
			  File dir = new File(getfolderStructure);
			  dir.mkdirs();
			
			 
			  }
			  catch (Exception e){System.err.println("Error: " + e.getMessage());}
			  
			  
			  
			  //reading to buffer, writing file to the folder and saving it
			  try (
					  BufferedInputStream in = new BufferedInputStream(new URL(fileIN).openStream());
					  FileOutputStream fileOutputStream = new FileOutputStream(fileOut)) {
					    byte dataBuffer[] = new byte[1024];
					    int bytesRead;
					    while ((bytesRead = in.read(dataBuffer, 0, 1024)) != -1) {
					        fileOutputStream.write(dataBuffer, 0, bytesRead);
					    }
					} catch (IOException e) {
					    // handle exception
					}

			  
			  
			  
			  
			  
			  
			  
			  
			  

			  }
			}
}
